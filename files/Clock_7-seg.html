<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta http-equiv="Content-Language" content="en"><meta name="msapplication-TileColor" content="#2d89ef"><meta name="theme-color" content="#4188c9"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="mobile-web-app-capable" content="yes"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta charset="UTF-8"><link href="style.css.gz" rel="stylesheet"><title>Template</title><style>button{font-size:1.1em}</style></head><body><div id="loader" class="loader"></div><ul class="nav fix info" id="navbar"><li><a href="index.html" class="brand">DOT</a></li><li><a href="settings.html">Settings</a></li><li><a href="service.html">Service</a></li><li class="-exit"><a href="#" id="btn_exit" onclick="logout()">Exit</a></li><li class="-icon"><a href="#" onclick='document.getElementById("navbar").classList.toggle("res")'>&equiv;</a></li></ul><div id="Modal" class="modal hide"><div class="m-cont"><span class="close" id="close_m" onclick="closeM()">&times;</span><div class="m-body"><p>The plugin is not running.</p></div><div class="m-foo"><button id="save_m" onclick="closeM()" class="success">OK</button></div></div></div><div class="cont"><div class="row"><div class="s12 m2 l2"></div><div class="s12 m10 l9"><h1>Settings</h1><div class="row"><div class="s12 m6 l6"><h2>Date and time</h2><div class="row"><div class="s6 m6 l6"><input id="time" type="datetime-local" value="
<?lua return(dofile('Clock_7-seg_DS3231.lua')({getStr=true}))?>" pattern="[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}" required></div><div class="s6 m6 l6"><button onclick="set_time()">Save</button></div></div><h2>Brightness</h2><div class="row"><div class="s8 m8 l8"><div class="group"><input type="range" min="1" max="1023" id="pwm_day" value="
<?lua return(_Clock_7seg.pwm_day)?>"> <label>Day</label></div></div><div class="s4 m4 l4"><div class="group"><button class="warning" onclick='pwm("pwm_day")'>Set</button></div></div></div><div class="row"><div class="s8 m8 l8"><div class="group"><input type="range" min="1" max="1023" id="pwm_night" value="
<?lua return(_Clock_7seg.pwm_night)?>"> <label>Night</label></div></div><div class="s4 m4 l4"><div class="group"><button class="warning" onclick='pwm("pwm_night")'>Set</button></div></div></div><h2>Switching threshold</h2><div class="row"><div class="s8 m8 l8"><div class="group"><input type="range" min="1" max="1023" id="adc_trig" oninput='document.getElementById("sp").innerHTML=this.value' value="
<?lua return(_Clock_7seg.adc_trig)?>"> <label>Night</label> <label style="position:absolute;top:-20px;right:10px">Day</label> <b id="sp" style="position:absolute;bottom:-20px;right:45%">
<?lua return(_Clock_7seg.adc_trig)?></b></div></div><div class="s4 m4 l4"><div class="group"><button class="warning" onclick='pwm("adc_trig")'>Set</button></div></div></div></div><div class="s12 m5 l5"><h2>Information</h2><div class="row">Temperature :
<?lua return(dofile('Clock_7-seg_DS3231.lua')({temp=true}))?> <br>Light :
<?lua return(adc.read(0))?> <br></div></div></div><div class="row"><div class="s12"><div class="group right"><button class="success" onclick="save()">Save</button></div></div></div></div></div></div><footer class="footer"><div class="row"><div class="s12 l11 of-l1"><ul><li class="p-4"><a href="http://dot.codedevice.ru" target="_blank">DoT</a></li><li class="p-4"><a href="http://codedevice.ru" target="_blank">CodeDevice.ru</a></li><li class="p-4"><a href="https://github.com/bondrogeen/DoT" target="_blank">Source code</a></li></ul></div></div></footer><script>function logout(){document.cookie="id=",location.href="/login.html"}function send(e,t,n){var i=new XMLHttpRequest;i.open("POST",e,!0),i.setRequestHeader("Content-Type","application/json"),i.addEventListener("load",function(){i.status<400?n(i.responseText):n(!1)}),i.send(JSON.stringify(t))}function id(e){return document.getElementById(e).value}function pwm(e){var t={};t.type=e,t.data=+id(e),send("Clock_7-seg.lua",{pwm:t},function(e){})}function set_time(){var e=[],t=document.getElementById("time").value;t=(t=t.replace(/(\d+)\-(\d+)\-(\d+)\T(\d+)\:(\d+)/,"$1,$2,$3,$4,$5")).split(","),e[6]=t[0].substr(-2),e[5]=t[1],e[4]=t[2],e[2]=t[3],e[1]=t[4],e[0]=0,e[3]=1,send("Clock_7-seg_DS3231.lua",{set:e},function(e){e?alert("Date and time set"):alert("Error")})}function save(){var e={Fname:"Clock_7-seg.init"};e.pwm_night=+id("pwm_night"),e.pwm_day=+id("pwm_day"),e.adc_trig=+id("adc_trig"),send("init_settings.lua",{save:e},function(e){e?alert("Saved"):alert("Not saved"),console.log(e)}),console.log(e)}</script></body></html>
